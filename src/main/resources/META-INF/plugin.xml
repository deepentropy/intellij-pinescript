<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>com.tradingview.pinescript</id>
    <name>PineScript Language Support</name>
    <vendor email="support@example.com" url="https://github.com/yourusername/pinescript-plugin">
        Your Name
    </vendor>

    <description><![CDATA[
      Adds comprehensive PineScript v6 language support to PyCharm and IntelliJ IDEA.
      <br/>
      Features:
      <ul>
        <li>Full syntax highlighting for PineScript v6</li>
        <li>Support for user-defined types (UDTs) with 'type' keyword</li>
        <li>Enum declarations and usage</li>
        <li>Method syntax for custom functions</li>
        <li>Switch statement support</li>
        <li>Annotation highlighting (@version, @type, @enum, @field, etc.)</li>
        <li>Extensive code completion for 500+ built-in functions</li>
        <li>Support for all namespaces: ta, array, matrix, map, str, color, request, strategy, and more</li>
        <li>Smart bracket matching and quote handling</li>
        <li>Code style and formatting support</li>
      </ul>
    ]]></description>

    <!-- Changelog for the plugin -->
    <change-notes><![CDATA[
      <h3>Version 1.0.0 - PineScript v6 Support</h3>
      <ul>
        <li><strong>PineScript v6 Syntax:</strong> Full support for v6 features including type, enum, method, and switch keywords</li>
        <li><strong>User-Defined Types:</strong> Syntax highlighting and completion for custom types</li>
        <li><strong>Annotations:</strong> Special highlighting for @version, @type, @enum, @field, @function, @param, @returns, @variable, and @description</li>
        <li><strong>Expanded Completion:</strong> 500+ autocomplete items covering all major namespaces</li>
        <li><strong>New Collections:</strong> Support for map.* and matrix.* functions</li>
        <li><strong>Drawing Objects:</strong> Completion for polyline.* and linefill.* (v6 features)</li>
        <li><strong>Enhanced Arrays:</strong> Full array.* function library</li>
        <li><strong>Technical Analysis:</strong> Comprehensive ta.* function set with 50+ indicators</li>
        <li><strong>Built-in Variables:</strong> Extended support for barstate, syminfo, timeframe, and chart namespaces</li>
        <li><strong>Color Support:</strong> color.* functions and constants</li>
        <li><strong>Input Functions:</strong> All input types including input.enum for v6</li>
      </ul>
    ]]>
    </change-notes>

    <!-- Minimum IDE version -->
    <idea-version since-build="231.0"/>

    <!-- Declare dependency on core IDE functionality -->
    <depends>com.intellij.modules.lang</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Language registration -->
        <lang.language id="PineScript"
                      implementationClass="com.tradingview.pinescript.PineScriptLanguage"/>

        <!-- File type registration -->
        <fileType name="PineScript"
                  implementationClass="com.tradingview.pinescript.PineScriptFileType"
                  language="PineScript"
                  extensions="pine;pinescript"/>

        <!-- Lexer factory -->
        <lang.syntaxHighlighterFactory language="PineScript"
                                       implementationClass="com.tradingview.pinescript.highlighting.PineScriptSyntaxHighlighterFactory"/>

        <!-- Color settings page -->
        <colorSettingsPage implementation="com.tradingview.pinescript.highlighting.PineScriptColorSettingsPage"/>

        <!-- Completion contributor -->
        <completion.contributor language="PineScript"
                               implementationClass="com.tradingview.pinescript.completion.PineScriptCompletionContributor"/>

        <!-- Bracket matching -->
        <lang.braceMatcher language="PineScript"
                          implementationClass="com.tradingview.pinescript.PineScriptBraceMatcher"/>

        <!-- Quote handler -->
        <lang.quoteHandler language="PineScript"
                          implementationClass="com.tradingview.pinescript.PineScriptQuoteHandler"/>

        <!-- Code style settings -->
        <lang.codeStyleSettingsProvider
            implementation="com.tradingview.pinescript.PineScriptCodeStyleSettingsProvider"/>
    </extensions>

    <actions>
        <!-- Optional: Add menu items or toolbar actions here -->
    </actions>
</idea-plugin>