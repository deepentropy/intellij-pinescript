<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>io.github.houseofai.pinescript</id>
    <name>Pine Script Support</name>
    <vendor>House of AI</vendor>

    <description><![CDATA[
      Pine Script language support for IntelliJ-based IDEs with syntax highlighting.
      <br/><br/>
      This is an independent, non-commercial plugin that provides IDE support for Pine Script language.
      Not affiliated with or endorsed by TradingView.
      <br/><br/>
      <b>Features:</b>
      <ul>
        <li>Syntax highlighting for Pine Script code</li>
        <li>Support for Pine Script v6 keywords and syntax</li>
        <li>Built-in function recognition (ta.*, math.*, input.*, color.*, etc.)</li>
        <li>Code completion for Pine Script built-in functions and namespaces</li>
        <li>Recognition of Pine Script constants and namespaces</li>
        <li>Proper handling of hex colors, operators, and special syntax</li>
        <li>No false spell-check warnings for Pine Script-specific identifiers</li>
      </ul>
      <br/>
      Useful for developing trading strategies and technical indicators.
    ]]></description>

    <change-notes><![CDATA[
      <h3>Version 1.0.0</h3>
      <ul>
        <li>Initial release with full Pine Script v6 support</li>
        <li>Syntax highlighting with appropriate colors</li>
        <li>Code completion for major Pine Script namespaces</li>
        <li>Support for indicator, strategy, and library declarations</li>
        <li>Built-in function recognition and highlighting</li>
        <li>Proper handling of ternary operators and special characters</li>
        <li>Disabled spell checking for Pine Script keywords</li>
      </ul>
    ]]>
    </change-notes>

    <!-- Minimum IDE version -->
    <idea-version since-build="231.0"/>

    <!-- Declare dependency on core IDE functionality -->
    <depends>com.intellij.modules.lang</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- File type registration -->
        <fileType name="PineScript"
                  implementationClass="io.github.houseofai.pinescript.PineScriptFileType"
                  fieldName="INSTANCE"
                  language="PineScript"
                  extensions="pine;pinescript"/>

        <!-- Syntax highlighter factory -->
        <lang.syntaxHighlighterFactory language="PineScript"
                                       implementationClass="io.github.houseofai.pinescript.highlighting.PineScriptSyntaxHighlighterFactory"/>

        <!-- Color settings page -->
        <colorSettingsPage implementation="io.github.houseofai.pinescript.highlighting.PineScriptColorSettingsPage"/>

        <!-- Completion contributor -->
        <completion.contributor language="PineScript"
                               implementationClass="io.github.houseofai.pinescript.completion.PineScriptCompletionContributor"/>

        <!-- Bracket matching -->
        <lang.braceMatcher language="PineScript"
                          implementationClass="io.github.houseofai.pinescript.PineScriptBraceMatcher"/>

        <!-- Quote handler -->
        <lang.quoteHandler language="PineScript"
                          implementationClass="io.github.houseofai.pinescript.PineScriptQuoteHandler"/>

        <!-- Code style settings -->
        <lang.codeStyleSettingsProvider
            implementation="io.github.houseofai.pinescript.PineScriptCodeStyleSettingsProvider"/>

        <!-- Spell checking strategy - disable for PineScript -->
        <spellchecker.support language="PineScript"
                             implementationClass="io.github.houseofai.pinescript.PineScriptSpellcheckingStrategy"/>

        <!-- Parameter info handler -->
        <codeInsight.parameterInfo language="PineScript"
                                  implementationClass="io.github.houseofai.pinescript.parameterinfo.PineScriptParameterInfoHandler"/>
    </extensions>

    <actions>
        <!-- Optional: Add menu items or toolbar actions here -->
    </actions>
</idea-plugin>