<?xml version="1.0" encoding="UTF-8"?>
<idea-plugin>
    <id>io.github.houseofai.pinescript</id>
    <name>PineScript v6 Language Support</name>
    <vendor>House of AI</vendor>

    <description><![CDATA[
      Comprehensive PineScript v6 language support for IntelliJ-based IDEs.
      <br/><br/>
      This is an independent, non-commercial plugin that provides IDE support for Pine Script language.
      Not affiliated with or endorsed by TradingView.
      <br/><br/>
      <b>Features:</b>
      <ul>
        <li><strong>Full PineScript v6 Syntax:</strong> Support for type, enum, method, and switch keywords</li>
        <li><strong>Syntax Highlighting:</strong> Distinct colors for keywords, annotations, operators, and more</li>
        <li><strong>Annotation Support:</strong> Special highlighting for @version, @type, @enum, @field, @function, @param, @returns, @variable, and @description</li>
        <li><strong>Extensive Code Completion:</strong> 500+ autocomplete items for all major PineScript namespaces</li>
        <li><strong>Parameter Hints:</strong> Shows function parameters as you type</li>
        <li><strong>Technical Analysis:</strong> Complete ta.* function library with 50+ indicators</li>
        <li><strong>Collections:</strong> Full support for array.*, matrix.*, and map.* functions</li>
        <li><strong>Drawing Objects:</strong> line.*, label.*, box.*, polyline.*, linefill.* functions</li>
        <li><strong>Smart Features:</strong> Bracket matching, quote handling, code style settings</li>
        <li><strong>No False Warnings:</strong> Spell checking disabled for PineScript-specific identifiers</li>
      </ul>
      <br/>
      Perfect for developing trading strategies and technical indicators.
    ]]></description>

    <change-notes><![CDATA[
      <h3>Version 1.0.1 - Compatibility Update</h3>
      <ul>
        <li><strong>Extended IDE Support:</strong> Now compatible with PyCharm/IntelliJ 2025.2 and 2025.3</li>
        <li><strong>API Updates:</strong> Removed deprecated API usage for better forward compatibility</li>
        <li><strong>Code Style Settings:</strong> Improved code style provider implementation</li>
      </ul>

      <h3>Version 1.0.0 - PineScript v6 Support</h3>
      <ul>
        <li><strong>PineScript v6 Syntax:</strong> Full support for v6 features including type, enum, method, and switch keywords</li>
        <li><strong>User-Defined Types:</strong> Syntax highlighting for custom types</li>
        <li><strong>Annotations:</strong> Special highlighting for @version, @type, @enum, @field, @function, @param, @returns, @variable, and @description</li>
        <li><strong>Parameter Hints:</strong> Shows function parameters with types and default values as you type</li>
        <li><strong>Expanded Completion:</strong> 500+ autocomplete items covering all major namespaces</li>
        <li><strong>Technical Analysis:</strong> Comprehensive ta.* function set with 50+ indicators</li>
        <li><strong>Collections:</strong> Support for map.* and matrix.* functions (v6 features)</li>
        <li><strong>Drawing Objects:</strong> Completion for polyline.* and linefill.* (v6 features)</li>
        <li><strong>Built-in Variables:</strong> Extended support for barstate, syminfo, timeframe, and chart namespaces</li>
        <li><strong>Input Functions:</strong> All input types including input.enum for v6</li>
      </ul>
    ]]>
    </change-notes>

    <!-- Minimum IDE version -->
    <idea-version since-build="231.0"/>

    <!-- Declare dependency on core IDE functionality -->
    <depends>com.intellij.modules.lang</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Language registration -->
        <lang.parserDefinition language="PineScript"
                              implementationClass="io.github.houseofai.pinescript.parser.PineScriptParserDefinition"/>

        <!-- File type registration -->
        <fileType name="PineScript"
                  implementationClass="io.github.houseofai.pinescript.PineScriptFileType"
                  fieldName="INSTANCE"
                  language="PineScript"
                  extensions="pine;pinescript"/>

        <!-- Syntax highlighter factory -->
        <lang.syntaxHighlighterFactory language="PineScript"
                                       implementationClass="io.github.houseofai.pinescript.highlighting.PineScriptSyntaxHighlighterFactory"/>

        <!-- Color settings page -->
        <colorSettingsPage implementation="io.github.houseofai.pinescript.highlighting.PineScriptColorSettingsPage"/>

        <!-- Completion contributor -->
        <completion.contributor language="PineScript"
                               implementationClass="io.github.houseofai.pinescript.completion.PineScriptCompletionContributor"/>

        <!-- Bracket matching -->
        <lang.braceMatcher language="PineScript"
                          implementationClass="io.github.houseofai.pinescript.PineScriptBraceMatcher"/>

        <!-- Quote handler -->
        <lang.quoteHandler language="PineScript"
                          implementationClass="io.github.houseofai.pinescript.PineScriptQuoteHandler"/>

        <!-- Code style settings -->
        <lang.codeStyleSettingsProvider
            implementation="io.github.houseofai.pinescript.PineScriptCodeStyleSettingsProvider"/>

        <!-- Spell checking strategy - disable for PineScript -->
        <spellchecker.support language="PineScript"
                             implementationClass="io.github.houseofai.pinescript.PineScriptSpellcheckingStrategy"/>

        <!-- Parameter info handler -->
        <codeInsight.parameterInfo language="PineScript"
                                  implementationClass="io.github.houseofai.pinescript.parameterinfo.PineScriptParameterInfoHandler"/>

        <!-- Documentation provider (hover docs) -->
        <lang.documentationProvider language="PineScript"
                                   implementationClass="io.github.houseofai.pinescript.documentation.PineScriptDocumentationProvider"/>
    </extensions>

    <actions>
        <!-- Optional: Add menu items or toolbar actions here -->
    </actions>
</idea-plugin>
